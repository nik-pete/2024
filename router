#############################################
# доменное имя
####Linux:
hostnamectl set-hostname ИМЯ.ДОМЕН










#########################################################################
#ESR
r#show interface status
#Uplink
r#configure
r(config)#interface gi1/0/1
r(config-if-gi)#ip address dhcp
r(config-if-gi)#ip firewall disable
r(config-if-gi)#no shutdown
r(config-if-gi)#exit
r(config)#interface gi1/0/2
r(config-if-gi)#no shutdown
r(config-if-gi)#exit

r(config)#interface gi1/0/2.33
r(config-if-gi)#ip address 192.168.2.1/29
r(config-if-gi)#ip firewall disable
r(config-if-gi)#exit

#Настройка динамической трансляции адресов

r(config)#object-group network LAN							              Создаем профиль адресов локальной сети с именем LAN
r(config-object-group-network)#ip prefix 192.168.2.0/24			Указываем префикс сети которой разрешен выход в публичную сеть
r(config-object-group-network)#exit
r(config)#nat source											                   	Конфигурируем сервис SNAT
r(config-snat)#ruleset NAT							            Создаем набор правил c именем MNAT
r(config-snat-ruleset)#to interface gi1/0/1					      	Указываем, что правила применяются только для пакетов направляющихся в публичную сеть через внешний интерфейс 
r(config-snat-ruleset)#rule 10									              Создаем правило 10
r(config-snat-rule)#match source-address LAN					      	Правила включают проверку адреса источника данных на принадлежность к пулу LAN.
r(config-snat-rule)#action source-nat interface				    	Адреса, попадающие под правило, меняют адрес на адрес внешнего интерфейса
r(config-snat-rule)#enable										                Включаем правило
r(config-snat-rule)#exit
r(config-snat-rule)#exit
r(config-snat-rule)#exit
r(config)#exit
r#commit
r#confirm
r#save



#########################################################################################
############tunnel
#Ecorouter
r(config)#interface tunnel.<НОМЕР>										                  	Создание интерфейса туннеля, где номер произвольное число, например, для R-DT interface tunnel.1
r(config-if-tunnel)#ip add <IP АДРЕС ТУННЕЛЯ>								            Назначение ip адреса, например, для R-DT ip add 10.10.10.1/30
r(config-if-tunnel)#ip mtu <ЗНАЧЕНИЕ>									                	Задание значения mtu для интерфейса, например, для R-DT  ip mtu 1400
r(config-if-tunnel)#ip tunnel <source IP> <destination IP> mode gre			Задание IP-адресов начала и конца туннеля и типа туннеля, например, для R-DT ip tunnel 172.16.4.14 172.16.6.2 mode gre
r(config-if-tunnel)#exit
r(config)#

#ESR
r(config)#tunnel gre <НОМЕР>								                  	Создаём интерфейс gre, где номер произвольное число, например, для R-BR tunnel gre 1
r(config-gre)#ip add <IP АДРЕС ТУННЕЛЯ>					            	Назначение ip адреса, например, для R-BR ip add 10.10.10.2/30
r(config-gre)#local interface <ИМЯ ВНЕШНЕГО ИНТЕРФЕЙСА>        Указываем имя внешнего интерфейса, например, для R-BR local interface gi1/0/1
r(config-gre)#remote address <ВНЕШНИЙ АДРЕС СОСЕДА>			      Указываем внешний адрес противоположенной стороны, например, для R-BR remote address 172.16.4.14
r(config-gre)#mtu <ЗНАЧЕНИЕ>									                  Задание значения mtu для интерфейса, например, для R-BR mtu 1400
r(config-gre)#ttl <ЗНАЧЕНИЕ>									                  Задание значения TTL для интерфейса, например, для R-BR ttl 64
r(config-gre)#ip firewall disable
r(config-gre)#enable
r(config-gre)#exit
r#show tunnel status



##########OSPF
#Ecorouter
r(config)#router ospf 1
r(config-router)#network 10.10.10.0/30 area 0.0.0.0
r(config-router)#network 10.10.11.0/30 area 0.0.0.0
r(config-router)#network 192.168.3.0/26 area 0.0.0.0
r(config-router)#network 192.168.3.64/29 area 0.0.0.0
r(config-router)#passive-interface default
r(config-router)#no passive-interface tunnel.1
r(config-router)#no passive-interface tunnel.2
r(config-router)#exit
r(config)#

#ESR
r(config)#router ospf 1
r(config-ospf)#area 0.0.0.0
r(config-ospf-area)#network 10.10.10.0/30
r(config-ospf-area)#network 10.10.12.0/30
r(config-ospf-area)#network 192.168.2.0/29
r(config-ospf-area)#enable
r(config-ospf-area)#exit
r(config-ospf)#enable
r(config-ospf)#exit
r(config)#
r(config-gre)#tunnel gre 1
r(config-gre)#ip ospf instance 1
r(config-gre)#ip ospf
r(config-gre)#exit
r(config)#
r(config)#do commit
r(config)#do confirm


#####Настройка OSPF парольная защита
#Ecorouter
r(config)#interface tunnel.1
r(config-if-tunnel)#ip ospf authentication
r(config-if-tunnel)#ip ospf authentication-key P@ssw0rd 
r(config-if-tunnel)#exit
r(config)#

#ESR
r(config-gre)#tunnel gre 1
r(config-gre)#ip ospf authentication key ascii-text P@ssw0rd 
r(config-gre)#ip ospf authentication algorithm cleartext
r(config-gre)#exit
r(config)#
r(config)#do commit
r(config)#do confirm


###############################################################################



#Настройка DHCP-Server на vESR
r(config)#ip dhcp-server pool <ИМЯ ПУЛА>										                  Создадим пул адресов с именем <ИМЯ ПУЛА>
r(config-dhcp-server)#network <IP АДРЕС СЕТИ>							                	Указываем адрес сети, из которой выдавать адреса
r(config-dhcp-server)#address-range <НАЧАЛЬНЫЙ АДРЕС> - <КОНЕЧНЫЙ АДРЕС>		  Определяем диапазон адресов, разрешенных для распределения
r(config-dhcp-server)#excluded-address-range <АДРЕС> - <АДРЕС>			        	Определяем диапазон адресов, не разрешенных для распределения (команду можно повторять сколько угодно раз, для исключения нужных адресов или диапазонов)
r(config-dhcp-server)#default-router <АДРЕС ШЛЮЗА>						              	Определяем параметра DHCP 3 (список маршрутизаторов по умолчанию)
r(config-dhcp-server)#domain-name "<ДОМЕННОЕ ИМЯ>"						               	Определяем параметра DHCP 15 (доменное имя)		
r(config-dhcp-server)#dns-server <АДРЕС DNS 1>, <АДРЕС DNS 2>			        	Определяем параметра DHCP 6 (список DNS-серверов)
r(config-dhcp-server)#exit

r(config)#ip dhcp-server														Включаем DHCP-сервер







































